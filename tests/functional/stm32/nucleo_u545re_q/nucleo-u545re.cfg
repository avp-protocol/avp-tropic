# Interface: Use the DAP version for ST-LINK/V3 (Critical for U5)
source [find interface/stlink-dap.cfg]

# Transport: Use DAP Direct SWD (Replaces hla_swd)
transport select dapdirect_swd

# Target: Use the built-in script from xPack
# (It contains the correct flash driver settings for U5 automatically)
source [find target/stm32u5x.cfg]

# Reset Config: Connect under reset to prevent locking up
reset_config srst_only srst_nogate connect_assert_srst

# Optional: If you want to force a lower speed to be safe
adapter speed 4000